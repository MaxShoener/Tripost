<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cloaker</title>
<style>
html,body{margin:0;padding:0;height:100%;font-family:sans-serif;display:flex;justify-content:center;align-items:center;background:#0b1220;}
#inputContainer{text-align:center;}
input{width:300px;padding:12px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;font-size:16px;}
button{width:300px;padding:12px;border:none;border-radius:6px;background:#0066ff;color:white;font-size:16px;cursor:pointer;}
button:hover{background:#0051cc;}
</style>
</head>
<body>

<div id="inputContainer">
  <input id="urlInput" placeholder="Enter URL or search term">
  <br>
  <button id="goBtn">Open Cloaked</button>
</div>

<script>
const input=document.getElementById('urlInput');
const btn=document.getElementById('goBtn');

function prepareTarget(raw){
  raw=(raw||'').trim();
  if(!raw) return null;
  if(/^(https?:\/\/)/i.test(raw)) return raw;
  if(/^\S+\.\S+$/.test(raw) && !/\s/.test(raw)) return 'http://'+raw;
  return 'https://www.google.com/search?q='+encodeURIComponent(raw);
}

function openCloaked(){
  const target=prepareTarget(input.value);
  if(!target){alert('Enter a URL or search term'); return;}

  const proxied='/proxy?u='+encodeURIComponent(target);

  const win=window.open('', '_blank');
  if(!win){alert('Popup blocked. Allow popups.'); return;}

  // fullscreen input hidden
  document.getElementById('inputContainer').style.display='none';

  win.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <title>Loading...</title>
      <style>
        html,body{margin:0;padding:0;height:100%;}
        body{display:flex;align-items:center;justify-content:center;background:#f3f3f3;}
        #spinner{border:6px solid #f3f3f3;border-top:6px solid #0066ff;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;}
        @keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
      </style>
    </head>
    <body>
      <div id="spinner"></div>
      <script>
        setTimeout(()=>{document.body.innerHTML='<iframe src="${proxied}" style="position:fixed;top:0;left:0;width:100%;height:100%;border:0;"></iframe>';},10);
      </script>
    </body>
    </html>
  `);
  win.document.close();
}

btn.addEventListener('click', openCloaked);
input.addEventListener('keydown', e=>{if(e.key==='Enter') openCloaked();});
</script>

</body>
</html>